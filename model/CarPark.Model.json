{"version":"2.0","models":[{"Key":"4","Name":"CarPark","Definition":{"version":"v2","attributes":[],"flows":{"blocks":[{"title":"Output","type":"actionoutput","id":"e248dbf8-ca1c-4394-d44b-1eb90c6534e1","position":{"left":639,"top":512},"surface":"UpdateCarParks","connections":{"inputs":[{"source":"db4f4b32-3312-4362-b421-21b530ff7a99:output:done","target":"e248dbf8-ca1c-4394-d44b-1eb90c6534e1:input:trigger"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"ok","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"status"},{"title":"Output","type":"actionoutput","id":"d06bd185-6927-4217-d127-9a3e295e3853","position":{"left":638,"top":319},"surface":"UpdateCarParks","connections":{"inputs":[{"source":"db4f4b32-3312-4362-b421-21b530ff7a99:output:done","target":"d06bd185-6927-4217-d127-9a3e295e3853:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"updated"},{"title":"Output","type":"actionoutput","id":"7222c7a4-2c31-4d0d-f33b-004502922685","position":{"left":1081,"top":11},"surface":"GetOccupancy","connections":{"inputs":[{"source":"17916e3f-a049-42d4-d125-6bb1a459c8d2:output:name","target":"7222c7a4-2c31-4d0d-f33b-004502922685:input:input"},{"source":"d3373ff6-6eb3-4b95-b429-e9ae9ec3ec7e:output:true","target":"7222c7a4-2c31-4d0d-f33b-004502922685:input:trigger"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"name"},{"title":"Action","type":"actionstart","id":"ab9a294e-98ca-4964-ed59-ade5ebdbb6e5","position":{"left":100,"top":100},"surface":"GetTotalOccupancy","connections":{"inputs":[],"outputs":[{"source":"ab9a294e-98ca-4964-ed59-ade5ebdbb6e5:output:output","target":"12622102-7474-4535-8fcd-27d00acac789:input:trigger"},{"source":"ab9a294e-98ca-4964-ed59-ade5ebdbb6e5:output:output","target":"2b0f2e21-46a1-4fe0-eab7-51e4448fea16:input:trigger"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":""}],"actionName":"GetTotalOccupancy","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false},{"title":"Action","type":"actionstart","id":"e4d2422d-1ffd-4084-c17a-9c4b824a4e39","position":{"left":100,"top":100},"surface":"GetCarParks","connections":{"inputs":[],"outputs":[{"source":"e4d2422d-1ffd-4084-c17a-9c4b824a4e39:output:output","target":"f2f3a0ff-e9a0-4ca7-8244-2e746e3ac61b:input:trigger"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":""}],"actionName":"GetCarParks","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false},{"title":"Repeat Action","type":"repeataction","id":"db4f4b32-3312-4362-b421-21b530ff7a99","position":{"left":316,"top":342},"surface":"UpdateCarParks","connections":{"inputs":[{"source":"02d4539b-e312-4939-ca57-a7476c00b591:output:carparks","target":"db4f4b32-3312-4362-b421-21b530ff7a99:input:list"}],"outputs":[{"source":"db4f4b32-3312-4362-b421-21b530ff7a99:output:action","target":"e0944c16-ef27-40f5-c772-734cab1b64ee:input:__actionlink__"},{"source":"db4f4b32-3312-4362-b421-21b530ff7a99:output:done","target":"d06bd185-6927-4217-d127-9a3e295e3853:input:input"},{"source":"db4f4b32-3312-4362-b421-21b530ff7a99:output:done","target":"e248dbf8-ca1c-4394-d44b-1eb90c6534e1:input:trigger"}]},"inputValues":[{"id":"list","type":"list","label":"Items","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"extra","type":"","label":"Extra","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"action","type":"actionlink","label":"Action","description":"","documentation":""},{"id":"done","type":"","label":"Done","description":"","documentation":""},{"id":"output","type":"","label":"Output","description":"","documentation":""}],"sequential":true},{"title":"Action","type":"actionstart","id":"59a0ce47-f0a1-49a4-8854-3104193ef37a","position":{"left":60,"top":60},"surface":"GetOccupants","connections":{"inputs":[],"outputs":[{"source":"59a0ce47-f0a1-49a4-8854-3104193ef37a:output:name","target":"508dd0d9-1a12-4f28-d935-4de2bda1b0d5:input:name"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"name","type":"","label":"name","description":"","documentation":""}],"actionName":"GetOccupants","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false},{"title":"Action","type":"actionstart","id":"26eb1be9-68b3-4afb-d7bd-dc081cfb3dcb","position":{"left":88,"top":349},"surface":"UpdateOccupancy","connections":{"inputs":[],"outputs":[{"source":"26eb1be9-68b3-4afb-d7bd-dc081cfb3dcb:output:carparks","target":"34c47428-ef68-4f7d-8f3d-053387a5967f:input:list"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"carparks","type":"","label":"carparks","description":"","documentation":""}],"actionName":"UpdateOccupancy","initiate":false,"published":false,"debug":true,"roles":[],"static":true,"canOverrideCredentials":false},{"title":"Find all documents","type":"modelcollections:findall","id":"1d67a197-2db6-4342-cf96-9ea18a44eefd","position":{"left":486,"top":137},"surface":"GetAllOccupants","connections":{"inputs":[{"source":"ce7b932b-9278-4e70-9f66-8d95f086e6dc:output:output","target":"1d67a197-2db6-4342-cf96-9ea18a44eefd:input:trigger"}],"outputs":[{"source":"1d67a197-2db6-4342-cf96-9ea18a44eefd:output:output","target":"1a93c1e8-817c-4697-c2b7-8906479dbded:input:input"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"output","type":"","label":"All Output","description":"","documentation":""}],"CollectionName":"8d053db5-0ad6-4211-d0b0-fe5ab37adb4f","configuration":"[]","UpdateAsAttributes":false,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"ES6Javascript","type":"es6javascript","id":"257fec87-8cd4-40c8-86f4-40468466ad23","position":{"left":540,"top":100},"surface":"GetTotalOccupancy","connections":{"inputs":[{"source":"12622102-7474-4535-8fcd-27d00acac789:output:output","target":"257fec87-8cd4-40c8-86f4-40468466ad23:input:occupancy"},{"source":"2b0f2e21-46a1-4fe0-eab7-51e4448fea16:output:output","target":"257fec87-8cd4-40c8-86f4-40468466ad23:input:capacity"}],"outputs":[{"source":"257fec87-8cd4-40c8-86f4-40468466ad23:output:capacity","target":"394971e9-efe9-4352-c433-20207c132a9e:input:input"},{"source":"257fec87-8cd4-40c8-86f4-40468466ad23:output:occupancy","target":"5d9a2dd9-6ca6-40ee-f8c1-3cb67fbf73e5:input:input"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"occupancy","type":"","label":"occupancy","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"capacity","type":"","label":"capacity","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"capacity","type":"","label":"capacity","description":"","documentation":""},{"id":"occupancy","type":"","label":"occupancy","description":"","documentation":""}],"description":"","code":"let occupancy = runtime.inputs().occupancy;\nlet totalOccupancy = 0;\nfor(var i in occupancy) {\n    totalOccupancy += Number(occupancy[i].value);\n}\n\nlet capacity = runtime.inputs().capacity;\nlet totalCapacity = 0;\nfor(var i in capacity) {\n    totalCapacity += Number(capacity[i].capacity);\n}\nruntime.done({occupancy:totalOccupancy,capacity:totalCapacity});","timeoutMilliseconds":5000},{"title":"Action","type":"actionstart","id":"02d4539b-e312-4939-ca57-a7476c00b591","position":{"left":88,"top":349},"surface":"UpdateCarParks","connections":{"inputs":[],"outputs":[{"source":"02d4539b-e312-4939-ca57-a7476c00b591:output:carparks","target":"db4f4b32-3312-4362-b421-21b530ff7a99:input:list"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"carparks","type":"","label":"carparks","description":"","documentation":""}],"actionName":"UpdateCarParks","initiate":false,"published":false,"debug":true,"roles":[],"static":true,"canOverrideCredentials":false},{"title":"Action","type":"actionstart","id":"b88a3d1e-279b-4037-f320-138c7bfa1d96","position":{"left":60,"top":60},"surface":"GetOccupancy","connections":{"inputs":[],"outputs":[{"source":"b88a3d1e-279b-4037-f320-138c7bfa1d96:output:name","target":"17916e3f-a049-42d4-d125-6bb1a459c8d2:input:name"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"name","type":"","label":"name","description":"","documentation":""}],"actionName":"GetOccupancy","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false},{"title":"Action","type":"linkedactionstart","id":"e0944c16-ef27-40f5-c772-734cab1b64ee","position":{"left":590,"top":75},"surface":"UpdateCarParks","connections":{"inputs":[{"source":"db4f4b32-3312-4362-b421-21b530ff7a99:output:action","target":"e0944c16-ef27-40f5-c772-734cab1b64ee:input:__actionlink__"}],"outputs":[{"source":"e0944c16-ef27-40f5-c772-734cab1b64ee:output:name","target":"7f06b125-f5e4-4744-f111-eba4e1f0c47e:input:name"},{"source":"e0944c16-ef27-40f5-c772-734cab1b64ee:output:capacity","target":"7f06b125-f5e4-4744-f111-eba4e1f0c47e:input:capacity"}]},"inputValues":[{"id":"__actionlink__","type":"actionlink","label":"","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"name","type":"","label":"name","description":"","documentation":""},{"id":"capacity","type":"","label":"capacity","description":"","documentation":""}],"actionName":"","initiate":false,"published":false,"debug":false,"roles":[],"static":true},{"title":"Find all documents","type":"modelcollections:findall","id":"2b0f2e21-46a1-4fe0-eab7-51e4448fea16","position":{"left":320,"top":320},"surface":"GetTotalOccupancy","connections":{"inputs":[{"source":"ab9a294e-98ca-4964-ed59-ade5ebdbb6e5:output:output","target":"2b0f2e21-46a1-4fe0-eab7-51e4448fea16:input:trigger"}],"outputs":[{"source":"2b0f2e21-46a1-4fe0-eab7-51e4448fea16:output:output","target":"257fec87-8cd4-40c8-86f4-40468466ad23:input:capacity"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"output","type":"","label":"All Output","description":"","documentation":""}],"CollectionName":"535e9b8b-cf35-40ec-c33d-77554be98384","configuration":"[]","UpdateAsAttributes":false,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Output","type":"actionoutput","id":"a42ce158-db0c-41bb-a16d-c8bcb6d6b6bd","position":{"left":1162,"top":153},"surface":"GetOccupants","connections":{"inputs":[{"source":"3aa2b254-daa2-4869-8206-f918441a0fd0:output:true","target":"a42ce158-db0c-41bb-a16d-c8bcb6d6b6bd:input:trigger"},{"source":"508dd0d9-1a12-4f28-d935-4de2bda1b0d5:output:occupants","target":"a42ce158-db0c-41bb-a16d-c8bcb6d6b6bd:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"occupants"},{"title":"Output","type":"actionoutput","id":"1a93c1e8-817c-4697-c2b7-8906479dbded","position":{"left":337,"top":390},"surface":"GetAllOccupants","connections":{"inputs":[{"source":"1d67a197-2db6-4342-cf96-9ea18a44eefd:output:output","target":"1a93c1e8-817c-4697-c2b7-8906479dbded:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":""},{"title":"Add Point","type":"timeseriesaddpoint","id":"fd05d1bd-da54-48d5-ac8a-bb24ea9d62d1","position":{"left":1364,"top":395},"surface":"UpdateOccupancy","connections":{"inputs":[{"source":"51b0dd28-fd56-48a2-8515-07f68ffcbbf1:output:output","target":"fd05d1bd-da54-48d5-ac8a-bb24ea9d62d1:input:trend"},{"source":"9ed3cac0-b2ef-4397-e1c5-9d50cb3a1fbf:output:occupancy","target":"fd05d1bd-da54-48d5-ac8a-bb24ea9d62d1:input:value"}],"outputs":[]},"inputValues":[{"id":"trend","type":"","label":"Trend Name","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"value","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"timestamp","type":"","label":"Timestamp","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"tags","type":"","label":"Tag List","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":""}]},{"title":"Action","type":"linkedactionstart","id":"cbefbbb3-6802-42c0-c21f-567351e54ed4","position":{"left":660,"top":47},"surface":"UpdateOccupancy","connections":{"inputs":[{"source":"34c47428-ef68-4f7d-8f3d-053387a5967f:output:action","target":"cbefbbb3-6802-42c0-c21f-567351e54ed4:input:__actionlink__"}],"outputs":[{"source":"cbefbbb3-6802-42c0-c21f-567351e54ed4:output:name","target":"48c59337-8ba3-4c6f-f69a-415244a7f864:input:name"},{"source":"cbefbbb3-6802-42c0-c21f-567351e54ed4:output:name","target":"51b0dd28-fd56-48a2-8515-07f68ffcbbf1:input:carpark"},{"source":"cbefbbb3-6802-42c0-c21f-567351e54ed4:output:name","target":"48c59337-8ba3-4c6f-f69a-415244a7f864:input:name"},{"source":"cbefbbb3-6802-42c0-c21f-567351e54ed4:output:occupants","target":"48c59337-8ba3-4c6f-f69a-415244a7f864:input:occupants"},{"source":"cbefbbb3-6802-42c0-c21f-567351e54ed4:output:occupants","target":"9ed3cac0-b2ef-4397-e1c5-9d50cb3a1fbf:input:occupants"},{"source":"cbefbbb3-6802-42c0-c21f-567351e54ed4:output:occupancy","target":"9ed3cac0-b2ef-4397-e1c5-9d50cb3a1fbf:input:occupancy"}]},"inputValues":[{"id":"__actionlink__","type":"actionlink","label":"","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"name","type":"","label":"name","description":"","documentation":""},{"id":"occupancy","type":"","label":"occupancy","description":"","documentation":""},{"id":"occupants","type":"","label":"occupants","description":"","documentation":""}],"actionName":"","initiate":false,"published":false,"debug":false,"roles":[],"static":true},{"title":"Find one document","type":"modelcollections:findone","id":"17916e3f-a049-42d4-d125-6bb1a459c8d2","position":{"left":390,"top":26},"surface":"GetOccupancy","connections":{"inputs":[{"source":"b88a3d1e-279b-4037-f320-138c7bfa1d96:output:name","target":"17916e3f-a049-42d4-d125-6bb1a459c8d2:input:name"}],"outputs":[{"source":"17916e3f-a049-42d4-d125-6bb1a459c8d2:output:value","target":"9d24e285-68b1-4c04-c3aa-889a3766a26b:input:input"},{"source":"17916e3f-a049-42d4-d125-6bb1a459c8d2:output:name","target":"7222c7a4-2c31-4d0d-f33b-004502922685:input:input"},{"source":"17916e3f-a049-42d4-d125-6bb1a459c8d2:output:name","target":"d3373ff6-6eb3-4b95-b429-e9ae9ec3ec7e:input:input1"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"name","type":"","label":"name","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"name","type":"","label":"name","description":"","documentation":""},{"id":"value","type":"","label":"value","description":"","documentation":""},{"id":"output","type":"","label":"All Output","description":"Entire result","documentation":""}],"CollectionName":"8d053db5-0ad6-4211-d0b0-fe5ab37adb4f","configuration":"[{\"IsEither\":true,\"Conditions\":[{\"Attribute\":\"name\",\"Operator\":\"eq\",\"Value\":\"name\",\"IsPin\":true}],\"Groups\":[]}]","UpdateAsAttributes":false,"ReceiveIndividualFields":true,"TakeFilterFromPin":false,"timeout":5000},{"title":"Exception","type":"exception","id":"edce796f-cf7b-41fb-c1bc-475625bf9927","position":{"left":779,"top":518},"surface":"GetOccupancy","connections":{"inputs":[{"source":"d3373ff6-6eb3-4b95-b429-e9ae9ec3ec7e:output:false","target":"edce796f-cf7b-41fb-c1bc-475625bf9927:input:trigger"}],"outputs":[]},"inputValues":[{"id":"message","type":"text","label":"Message","value":"Carpark Not Found","description":"","documentation":"","transformation":"","disablelog":""},{"id":"code","type":"text","label":"Status Code","value":"404","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[]},{"title":"Output","type":"actionoutput","id":"42c6b45a-59a3-4841-fbe4-f96e887728c0","position":{"left":638,"top":319},"surface":"UpdateOccupancy","connections":{"inputs":[{"source":"34c47428-ef68-4f7d-8f3d-053387a5967f:output:done","target":"42c6b45a-59a3-4841-fbe4-f96e887728c0:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"updated"},{"title":"Output","type":"actionoutput","id":"5d9a2dd9-6ca6-40ee-f8c1-3cb67fbf73e5","position":{"left":760,"top":320},"surface":"GetTotalOccupancy","connections":{"inputs":[{"source":"257fec87-8cd4-40c8-86f4-40468466ad23:output:occupancy","target":"5d9a2dd9-6ca6-40ee-f8c1-3cb67fbf73e5:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"occupancy"},{"title":"Find one document","type":"modelcollections:findone","id":"508dd0d9-1a12-4f28-d935-4de2bda1b0d5","position":{"left":390,"top":26},"surface":"GetOccupants","connections":{"inputs":[{"source":"59a0ce47-f0a1-49a4-8854-3104193ef37a:output:name","target":"508dd0d9-1a12-4f28-d935-4de2bda1b0d5:input:name"}],"outputs":[{"source":"508dd0d9-1a12-4f28-d935-4de2bda1b0d5:output:name","target":"3aa2b254-daa2-4869-8206-f918441a0fd0:input:input1"},{"source":"508dd0d9-1a12-4f28-d935-4de2bda1b0d5:output:name","target":"978323bd-3c7c-45a4-d0e5-7ccf9e192393:input:input"},{"source":"508dd0d9-1a12-4f28-d935-4de2bda1b0d5:output:occupants","target":"a42ce158-db0c-41bb-a16d-c8bcb6d6b6bd:input:input"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"name","type":"","label":"name","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"name","type":"","label":"name","description":"","documentation":""},{"id":"value","type":"","label":"value","description":"","documentation":""},{"id":"occupants","type":"","label":"occupants","description":"","documentation":""},{"id":"output","type":"","label":"All Output","description":"Entire result","documentation":""}],"CollectionName":"8d053db5-0ad6-4211-d0b0-fe5ab37adb4f","configuration":"[{\"IsEither\":true,\"Conditions\":[{\"Attribute\":\"name\",\"Operator\":\"eq\",\"Value\":\"name\",\"IsPin\":true}],\"Groups\":[]}]","UpdateAsAttributes":false,"ReceiveIndividualFields":true,"TakeFilterFromPin":false,"timeout":5000},{"title":"Action","type":"actionstart","id":"ce7b932b-9278-4e70-9f66-8d95f086e6dc","position":{"left":60,"top":60},"surface":"GetAllOccupants","connections":{"inputs":[],"outputs":[{"source":"ce7b932b-9278-4e70-9f66-8d95f086e6dc:output:output","target":"1d67a197-2db6-4342-cf96-9ea18a44eefd:input:trigger"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":""}],"actionName":"GetAllOccupants","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false},{"title":"Replace one document","type":"modelcollections:replaceone","id":"48c59337-8ba3-4c6f-f69a-415244a7f864","position":{"left":1391,"top":53},"surface":"UpdateOccupancy","connections":{"inputs":[{"source":"9ed3cac0-b2ef-4397-e1c5-9d50cb3a1fbf:output:occupancy","target":"48c59337-8ba3-4c6f-f69a-415244a7f864:input:value"},{"source":"cbefbbb3-6802-42c0-c21f-567351e54ed4:output:name","target":"48c59337-8ba3-4c6f-f69a-415244a7f864:input:name"},{"source":"cbefbbb3-6802-42c0-c21f-567351e54ed4:output:occupants","target":"48c59337-8ba3-4c6f-f69a-415244a7f864:input:occupants"}],"outputs":[]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"name","type":"","label":"name","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"value","type":"","label":"value","value":"","description":"","documentation":"","transformation":"text","disablelog":""},{"id":"occupants","type":"","label":"occupants","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"__data__","type":"text","label":"Data","value":"","description":"Data to be inserted","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"output","type":"","label":"All Output","description":"","documentation":""}],"CollectionName":"8d053db5-0ad6-4211-d0b0-fe5ab37adb4f","configuration":"[{\"IsEither\":true,\"Conditions\":[{\"Attribute\":\"name\",\"Operator\":\"eq\",\"Value\":\"name\",\"IsPin\":true}],\"Groups\":[]}]","UpdateAsAttributes":true,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Output","type":"actionoutput","id":"394971e9-efe9-4352-c433-20207c132a9e","position":{"left":760,"top":100},"surface":"GetTotalOccupancy","connections":{"inputs":[{"source":"257fec87-8cd4-40c8-86f4-40468466ad23:output:capacity","target":"394971e9-efe9-4352-c433-20207c132a9e:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"capacity"},{"title":"Repeat Action","type":"repeataction","id":"34c47428-ef68-4f7d-8f3d-053387a5967f","position":{"left":316,"top":342},"surface":"UpdateOccupancy","connections":{"inputs":[{"source":"26eb1be9-68b3-4afb-d7bd-dc081cfb3dcb:output:carparks","target":"34c47428-ef68-4f7d-8f3d-053387a5967f:input:list"}],"outputs":[{"source":"34c47428-ef68-4f7d-8f3d-053387a5967f:output:action","target":"cbefbbb3-6802-42c0-c21f-567351e54ed4:input:__actionlink__"},{"source":"34c47428-ef68-4f7d-8f3d-053387a5967f:output:done","target":"42c6b45a-59a3-4841-fbe4-f96e887728c0:input:input"},{"source":"34c47428-ef68-4f7d-8f3d-053387a5967f:output:done","target":"7764a7b7-ab4d-4be0-9901-6582c521e531:input:trigger"}]},"inputValues":[{"id":"list","type":"list","label":"Items","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"extra","type":"","label":"Extra","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"action","type":"actionlink","label":"Action","description":"","documentation":""},{"id":"done","type":"","label":"Done","description":"","documentation":""},{"id":"output","type":"","label":"Output","description":"","documentation":""}],"sequential":true},{"title":"ES6Javascript","type":"es6javascript","id":"9ed3cac0-b2ef-4397-e1c5-9d50cb3a1fbf","position":{"left":965,"top":247},"surface":"UpdateOccupancy","connections":{"inputs":[{"source":"cbefbbb3-6802-42c0-c21f-567351e54ed4:output:occupants","target":"9ed3cac0-b2ef-4397-e1c5-9d50cb3a1fbf:input:occupants"},{"source":"cbefbbb3-6802-42c0-c21f-567351e54ed4:output:occupancy","target":"9ed3cac0-b2ef-4397-e1c5-9d50cb3a1fbf:input:occupancy"}],"outputs":[{"source":"9ed3cac0-b2ef-4397-e1c5-9d50cb3a1fbf:output:occupancy","target":"fd05d1bd-da54-48d5-ac8a-bb24ea9d62d1:input:value"},{"source":"9ed3cac0-b2ef-4397-e1c5-9d50cb3a1fbf:output:occupancy","target":"48c59337-8ba3-4c6f-f69a-415244a7f864:input:value"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"occupancy","type":"","label":"occupancy","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"occupants","type":"","label":"occupants","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"occupancy","type":"","label":"occupancy","description":"","documentation":""}],"description":"Calculate Occupancy","code":"let occupancy = xint(runtime.inputs().occupancy);\nlet occupants = runtime.inputs().occupants;\nif (occupants && occupants.length > 0) {\n    runtime.done({occupancy:occupants.length});\n} else {\n    runtime.done({occupancy});\n}","timeoutMilliseconds":5000},{"title":"Replace one document","type":"modelcollections:replaceone","id":"7f06b125-f5e4-4744-f111-eba4e1f0c47e","position":{"left":899,"top":98},"surface":"UpdateCarParks","connections":{"inputs":[{"source":"e0944c16-ef27-40f5-c772-734cab1b64ee:output:name","target":"7f06b125-f5e4-4744-f111-eba4e1f0c47e:input:name"},{"source":"e0944c16-ef27-40f5-c772-734cab1b64ee:output:capacity","target":"7f06b125-f5e4-4744-f111-eba4e1f0c47e:input:capacity"}],"outputs":[]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"name","type":"","label":"name","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"capacity","type":"","label":"capacity","value":"","description":"","documentation":"","transformation":"text","disablelog":""},{"id":"__data__","type":"text","label":"Data","value":"","description":"Data to be inserted","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"output","type":"","label":"All Output","description":"","documentation":""}],"CollectionName":"535e9b8b-cf35-40ec-c33d-77554be98384","configuration":"[{\"IsEither\":true,\"Conditions\":[{\"Attribute\":\"name\",\"Operator\":\"eq\",\"Value\":\"name\",\"IsPin\":true}],\"Groups\":[]}]","UpdateAsAttributes":true,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Output","type":"actionoutput","id":"9d24e285-68b1-4c04-c3aa-889a3766a26b","position":{"left":1161,"top":241},"surface":"GetOccupancy","connections":{"inputs":[{"source":"17916e3f-a049-42d4-d125-6bb1a459c8d2:output:value","target":"9d24e285-68b1-4c04-c3aa-889a3766a26b:input:input"},{"source":"d3373ff6-6eb3-4b95-b429-e9ae9ec3ec7e:output:true","target":"9d24e285-68b1-4c04-c3aa-889a3766a26b:input:trigger"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"occupancy"},{"title":"Find all documents","type":"modelcollections:findall","id":"f2f3a0ff-e9a0-4ca7-8244-2e746e3ac61b","position":{"left":320,"top":100},"surface":"GetCarParks","connections":{"inputs":[{"source":"e4d2422d-1ffd-4084-c17a-9c4b824a4e39:output:output","target":"f2f3a0ff-e9a0-4ca7-8244-2e746e3ac61b:input:trigger"}],"outputs":[{"source":"f2f3a0ff-e9a0-4ca7-8244-2e746e3ac61b:output:output","target":"39fd23d0-8ee2-44d3-c98f-03e7e098e1b5:input:input"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"output","type":"","label":"All Output","description":"","documentation":""}],"CollectionName":"535e9b8b-cf35-40ec-c33d-77554be98384","configuration":"[]","UpdateAsAttributes":false,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Exception","type":"exception","id":"7fe05f95-2235-47f5-adaf-8d942167ace8","position":{"left":779,"top":518},"surface":"GetOccupants","connections":{"inputs":[{"source":"3aa2b254-daa2-4869-8206-f918441a0fd0:output:false","target":"7fe05f95-2235-47f5-adaf-8d942167ace8:input:trigger"}],"outputs":[]},"inputValues":[{"id":"message","type":"text","label":"Message","value":"Carpark Not Found","description":"","documentation":"","transformation":"","disablelog":""},{"id":"code","type":"text","label":"Status Code","value":"404","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[]},{"title":"Exists","type":"exists","id":"d3373ff6-6eb3-4b95-b429-e9ae9ec3ec7e","position":{"left":695,"top":170},"surface":"GetOccupancy","connections":{"inputs":[{"source":"17916e3f-a049-42d4-d125-6bb1a459c8d2:output:name","target":"d3373ff6-6eb3-4b95-b429-e9ae9ec3ec7e:input:input1"}],"outputs":[{"source":"d3373ff6-6eb3-4b95-b429-e9ae9ec3ec7e:output:true","target":"9d24e285-68b1-4c04-c3aa-889a3766a26b:input:trigger"},{"source":"d3373ff6-6eb3-4b95-b429-e9ae9ec3ec7e:output:true","target":"7222c7a4-2c31-4d0d-f33b-004502922685:input:trigger"},{"source":"d3373ff6-6eb3-4b95-b429-e9ae9ec3ec7e:output:false","target":"edce796f-cf7b-41fb-c1bc-475625bf9927:input:trigger"}]},"inputValues":[{"id":"input1","type":"","label":"Input 1","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"true","type":"","label":"True","description":"","documentation":""},{"id":"false","type":"","label":"False","description":"","documentation":""}]},{"title":"Template","type":"template","id":"51b0dd28-fd56-48a2-8515-07f68ffcbbf1","position":{"left":987,"top":551},"surface":"UpdateOccupancy","connections":{"inputs":[{"source":"cbefbbb3-6802-42c0-c21f-567351e54ed4:output:name","target":"51b0dd28-fd56-48a2-8515-07f68ffcbbf1:input:carpark"}],"outputs":[{"source":"51b0dd28-fd56-48a2-8515-07f68ffcbbf1:output:output","target":"fd05d1bd-da54-48d5-ac8a-bb24ea9d62d1:input:trend"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"carpark","type":"","label":"carpark","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"output","type":"","label":"Output Text","description":"","documentation":""}],"template":"carparks/#{carpark}"},{"title":"Output","type":"actionoutput","id":"39fd23d0-8ee2-44d3-c98f-03e7e098e1b5","position":{"left":540,"top":100},"surface":"GetCarParks","connections":{"inputs":[{"source":"f2f3a0ff-e9a0-4ca7-8244-2e746e3ac61b:output:output","target":"39fd23d0-8ee2-44d3-c98f-03e7e098e1b5:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":""},{"title":"Output","type":"actionoutput","id":"978323bd-3c7c-45a4-d0e5-7ccf9e192393","position":{"left":1081,"top":11},"surface":"GetOccupants","connections":{"inputs":[{"source":"3aa2b254-daa2-4869-8206-f918441a0fd0:output:true","target":"978323bd-3c7c-45a4-d0e5-7ccf9e192393:input:trigger"},{"source":"508dd0d9-1a12-4f28-d935-4de2bda1b0d5:output:name","target":"978323bd-3c7c-45a4-d0e5-7ccf9e192393:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"name"},{"title":"Find all documents","type":"modelcollections:findall","id":"12622102-7474-4535-8fcd-27d00acac789","position":{"left":320,"top":100},"surface":"GetTotalOccupancy","connections":{"inputs":[{"source":"ab9a294e-98ca-4964-ed59-ade5ebdbb6e5:output:output","target":"12622102-7474-4535-8fcd-27d00acac789:input:trigger"}],"outputs":[{"source":"12622102-7474-4535-8fcd-27d00acac789:output:output","target":"257fec87-8cd4-40c8-86f4-40468466ad23:input:occupancy"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":""},{"id":"output","type":"","label":"All Output","description":"","documentation":""}],"CollectionName":"8d053db5-0ad6-4211-d0b0-fe5ab37adb4f","configuration":"[]","UpdateAsAttributes":false,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Exists","type":"exists","id":"3aa2b254-daa2-4869-8206-f918441a0fd0","position":{"left":695,"top":170},"surface":"GetOccupants","connections":{"inputs":[{"source":"508dd0d9-1a12-4f28-d935-4de2bda1b0d5:output:name","target":"3aa2b254-daa2-4869-8206-f918441a0fd0:input:input1"}],"outputs":[{"source":"3aa2b254-daa2-4869-8206-f918441a0fd0:output:true","target":"a42ce158-db0c-41bb-a16d-c8bcb6d6b6bd:input:trigger"},{"source":"3aa2b254-daa2-4869-8206-f918441a0fd0:output:true","target":"978323bd-3c7c-45a4-d0e5-7ccf9e192393:input:trigger"},{"source":"3aa2b254-daa2-4869-8206-f918441a0fd0:output:false","target":"7fe05f95-2235-47f5-adaf-8d942167ace8:input:trigger"}]},"inputValues":[{"id":"input1","type":"","label":"Input 1","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"true","type":"","label":"True","description":"","documentation":""},{"id":"false","type":"","label":"False","description":"","documentation":""}]},{"title":"Output","type":"actionoutput","id":"7764a7b7-ab4d-4be0-9901-6582c521e531","position":{"left":639,"top":512},"surface":"UpdateOccupancy","connections":{"inputs":[{"source":"34c47428-ef68-4f7d-8f3d-053387a5967f:output:done","target":"7764a7b7-ab4d-4be0-9901-6582c521e531:input:trigger"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"ok","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"status"}],"position":{"top":0,"left":0}},"sources":[{"name":"GetTotalOccupancy","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["capacity","occupancy"],"parameters":[]},{"name":"GetCarParks","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":[]},{"name":"GetOccupants","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["occupants","name"],"parameters":["name"]},{"name":"UpdateOccupancy","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["updated","status"],"parameters":["carparks"]},{"name":"UpdateCarParks","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["updated","status"],"parameters":["carparks"]},{"name":"GetOccupancy","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["occupancy","name"],"parameters":["name"]},{"name":"GetAllOccupants","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":[]}],"actions":[{"name":"GetTotalOccupancy","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["capacity","occupancy"],"parameters":[]},{"name":"GetCarParks","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":[]},{"name":"GetOccupants","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["occupants","name"],"parameters":["name"]},{"name":"UpdateOccupancy","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["updated","status"],"parameters":["carparks"]},{"name":"UpdateCarParks","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["updated","status"],"parameters":["carparks"]},{"name":"GetOccupancy","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["occupancy","name"],"parameters":["name"]},{"name":"GetAllOccupants","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":[]}],"uioptions":{}},"UIDefinition":null,"MetadataDictionary":"{\"title\":\"Car Park Analytics\",\"description\":\"Provide usage analytics on car park systems\",\"parameters\":[],\"tags\":[\"carpark\"],\"capabilities\":[]}","ApiRoutes":[{"Key":"83","MapKey":"4","Route":"carparks","Method":"POST","BodyFormat":"JSON","IsActive":"0","Action":"UpdateCarParks","NoAuth":"0"},{"Key":"84","MapKey":"4","Route":"carparks/occupancy","Method":"POST","BodyFormat":"JSON","IsActive":"0","Action":"UpdateOccupancy","NoAuth":"0"},{"Key":"85","MapKey":"4","Route":"carparks","Method":"GET","BodyFormat":"JSON","IsActive":"0","Action":"GetCarParks","NoAuth":"0"},{"Key":"86","MapKey":"4","Route":"occupancy/{name}","Method":"GET","BodyFormat":"JSON","IsActive":"0","Action":"GetOccupancy","NoAuth":"0"},{"Key":"87","MapKey":"4","Route":"occupants/{name}","Method":"GET","BodyFormat":"JSON","IsActive":"0","Action":"GetOccupants","NoAuth":"0"}],"JSModules":[],"ModelCollections":[{"Key":"30","MapKey":"4","GUID":"535e9b8b-cf35-40ec-c33d-77554be98384","Attributes":"[{\"name\":\"name\"},{\"name\":\"capacity\"}]","Name":"carparks"},{"Key":"31","MapKey":"4","GUID":"8d053db5-0ad6-4211-d0b0-fe5ab37adb4f","Attributes":"[{\"name\":\"name\"},{\"name\":\"value\"},{\"name\":\"occupants\"}]","Name":"currentcapacity"}]}]}